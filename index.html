<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="shortcut icon" href="favicon.svg" type="image/svg" />
    <link rel="manifest" href="manifest.json" />
    <title>Coffee Bean Latte Compatibility Checker</title>

    <!-- OpenGraph Meta Tags -->
    <meta
      property="og:title"
      content="Coffee Bean Latte Compatibility Checker ‚òï"
    />
    <meta
      property="og:description"
      content="Not sure which coffee beans to use for lattes? Our tool helps you find the perfect coffee beans for milk-based drinks. Compare different coffee origins, processing methods, and roast levels to create the perfect latte at home or in your caf√©."
    />
    <meta property="og:type" content="website" />
    <meta property="og:url" content="https://latte-lovers.vercel.app" />
    <meta
      property="og:image"
      content="https://latte-lovers.vercel.app/og-image.png"
    />
    <meta
      property="og:image:alt"
      content="Coffee Bean Latte Compatibility Checker - Find the perfect coffee beans for your lattes"
    />

    <!-- Twitter Card Meta Tags -->
    <meta
      name="twitter:title"
      content="Coffee Bean Latte Compatibility Checker ‚òï"
    />
    <meta
      name="twitter:description"
      content="Not sure which coffee beans to use for lattes? Our tool helps you find the perfect coffee beans for milk-based drinks. Compare different coffee origins, processing methods, and roast levels to create the perfect latte at home or in your caf√©."
    />
    <meta
      name="twitter:image"
      content="https://latte-lovers.vercel.app/og-image.png"
    />

    <!-- Additional Meta Tags -->
    <meta
      name="description"
      content="Not sure which coffee beans to use for lattes? Our tool helps you find the perfect coffee beans for milk-based drinks. Compare different coffee origins, processing methods, and roast levels to create the perfect latte at home or in your caf√©."
    />
    <meta
      name="keywords"
      content="best coffee for lattes, coffee beans for milk drinks, which coffee is good for lattes, coffee bean guide, coffee selection guide, coffee and milk compatibility, best coffee beans for milk, coffee bean recommendations, coffee brewing guide, barista tips, coffee bean characteristics, coffee flavor guide, how to choose coffee beans, coffee bean comparison, coffee bean selection tool, coffee bean compatibility, coffee bean guide for lattes, best coffee for milk drinks, coffee bean recommendations for lattes, coffee bean selection for cafes, coffee bean guide for baristas, coffee bean characteristics guide, coffee bean flavor profile, coffee bean selection for milk drinks, coffee bean guide for home brewing"
    />
    <meta name="author" content="Lonli-Lokli" />

    <!-- Additional SEO Meta Tags -->
    <meta name="robots" content="index, follow" />
    <meta name="language" content="English" />
    <meta name="revisit-after" content="7 days" />
    <meta name="rating" content="general" />
    <meta name="distribution" content="global" />
    <meta name="category" content="Coffee Tools" />
    <meta name="coverage" content="Worldwide" />
    <meta name="target" content="all" />
    <meta name="HandheldFriendly" content="true" />
    <meta name="MobileOptimized" content="width" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="default" />
    <meta name="apple-mobile-web-app-title" content="Latte Lovers" />
    <link rel="apple-touch-icon" href="192x192.png" />
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body>
    <div class="container">
      <div class="header">
        <div class="header-content">
          <h1>
            <span class="coffee-emoji">‚òï</span>Coffee Bean Latte Compatibility
          </h1>
          <p>Find the perfect coffee beans for your milk-based drinks</p>
        </div>
        <div class="header-buttons">
          <button class="theme-toggle" title="Toggle theme">
            <span id="themeIcon">‚òÄÔ∏è</span>
          </button>
          <a href="#" class="header-btn">üìß Contact</a>
          <a
            href="https://buymeacoffee.com/lonlilokliV"
            class="header-btn"
            target="_blank"
            >‚òï Buy Me a Coffee</a
          >
          <button id="installPWA" class="header-btn hidden">
            üì± Save to Phone
          </button>
        </div>
      </div>

      <div class="form-container">
        <div class="form-group">
          <div class="floating-label">
            <select id="coffeeType">
              <option value="" disabled selected></option>
              <option value="single">Single Origin</option>
              <option value="blend">Blend</option>
            </select>
            <label for="coffeeType">Coffee Type</label>
          </div>
        </div>

        <div class="form-group" id="singleOriginGroup" style="display: none">
          <div class="floating-label">
            <select id="country">
              <option value="" disabled selected></option>
            </select>
            <label for="country">Country of Origin</label>
          </div>
        </div>

        <div class="form-group" id="blendGroup" style="display: none">
          <div class="floating-label blend-panel">
            <div class="blend-group" id="blendInputs">
              <div class="blend-item">
                <div class="floating-label">
                  <select id="blend1Country">
                    <option value="" disabled selected></option>
                  </select>
                  <label for="blend1Country">Country 1</label>
                </div>
                <div class="floating-label">
                  <input
                    type="number"
                    id="blend1Percent"
                    placeholder=" "
                    min="0"
                    step="10"
                    max="100"
                    inputmode="numeric"
                    oninput="this.value = this.value.replace(/[^0-9]/g, '');"
                  />
                  <label for="blend1Percent">Percentage</label>
                </div>
              </div>
              <div class="blend-item">
                <div class="floating-label">
                  <select id="blend2Country">
                    <option value="" disabled selected></option>
                  </select>
                  <label for="blend2Country">Country 2</label>
                </div>
                <div class="floating-label">
                  <input
                    type="number"
                    id="blend2Percent"
                    placeholder=" "
                    min="0"
                    step="10"
                    max="100"
                    inputmode="numeric"
                    oninput="this.value = this.value.replace(/[^0-9]/g, '');"
                  />
                  <label for="blend2Percent">Percentage</label>
                </div>
              </div>
            </div>
            <label>Blend Composition</label>
          </div>
          <div
            id="blendValidation"
            style="
              display: none;
              color: #f44336;
              font-size: 12px;
              margin-top: 8px;
            "
          ></div>
        </div>

        <div class="form-group">
          <div class="floating-label">
            <select id="processing">
              <option value="" disabled selected></option>
            </select>
            <label for="processing">Processing Method</label>
          </div>
        </div>

        <div class="form-group">
          <div class="floating-label">
            <select id="roastLevel">
              <option value="light">Light</option>
              <option value="medium" selected>Medium</option>
              <option value="dark">Dark</option>
            </select>
            <label for="roastLevel">Roast Level</label>
          </div>
        </div>

        <button class="check-btn">Check Latte Compatibility</button>

        <div id="result" class="result"></div>
      </div>
    </div>

    <!-- Contact Modal -->
    <div id="contactModal" class="modal">
      <div class="modal-content">
        <div class="modal-header">
          <h2>Get in Touch</h2>
          <span class="close">&times;</span>
        </div>
        <div class="modal-body">
          <form
            action="https://formsubmit.co/lonli.lokli@gmail.com"
            method="POST"
          >
            <input
              type="hidden"
              name="_subject"
              value="New message from Latte Coffee Checker"
            />
            <input type="hidden" name="_captcha" value="false" />
            <input type="hidden" name="_next" value="#contact-success" />

            <div class="modal-form-group">
              <label for="contactName">Name *</label>
              <input type="text" id="contactName" name="name" required />
            </div>

            <div class="modal-form-group">
              <label for="contactEmail">Email *</label>
              <input type="email" id="contactEmail" name="email" required />
            </div>

            <div class="modal-form-group">
              <label for="contactMessage">Message *</label>
              <textarea
                id="contactMessage"
                name="message"
                placeholder="Tell us about your coffee experience or suggestions..."
                required
              ></textarea>
            </div>

            <button type="submit" class="modal-submit-btn">Send Message</button>
          </form>
        </div>
      </div>
    </div>

    <script type="module">
      import {
        toggleBlendInputs,
        validateBlend,
        checkCoffee,
        toggleTheme,
        openContactModal,
        closeContactModal,
        coffeeProfiles,
        processingMethods,
      } from "./script.mjs";

      // Initialize country options
      function initializeCountryOptions() {
        const countrySelects = ["country", "blend1Country", "blend2Country"];
        const countries = Object.keys(coffeeProfiles).sort();

        countrySelects.forEach((selectId) => {
          const select = document.getElementById(selectId);
          countries.forEach((country) => {
            const option = document.createElement("option");
            option.value = country;
            option.textContent = country
              .split("-")
              .map((word) => word.charAt(0).toUpperCase() + word.slice(1))
              .join(" ");
            select.appendChild(option);
          });
        });
      }

      // Initialize processing options
      function initializeProcessingOptions() {
        const processingSelect = document.getElementById("processing");
        const methods = Object.entries(processingMethods);

        methods.forEach(([value, { displayName }]) => {
          const option = document.createElement("option");
          option.value = value;
          option.textContent = displayName;
          if (value === "washed") {
            option.selected = true;
          }
          processingSelect.appendChild(option);
        });
      }

      // Service Worker registration
      if ("serviceWorker" in navigator) {
        window.addEventListener("load", function () {
          navigator.serviceWorker
            .register("/sw.js")
            .then(function (registration) {
              // Registration successful
              console.log(
                "ServiceWorker registration successful with scope: ",
                registration.scope
              );
            })
            .catch(function (error) {
              // Registration failed
              console.log("ServiceWorker registration failed: ", error);
            });
        });
      }

      // Initialize options when DOM is loaded
      document.addEventListener("DOMContentLoaded", () => {
        initializeCountryOptions();
        initializeProcessingOptions();

        // Add event listeners
        document
          .getElementById("coffeeType")
          .addEventListener("change", toggleBlendInputs);
        document
          .getElementById("blend1Percent")
          .addEventListener("input", validateBlend);
        document
          .getElementById("blend2Percent")
          .addEventListener("input", validateBlend);
        document
          .querySelector(".check-btn")
          .addEventListener("click", checkCoffee);
        document
          .querySelector(".theme-toggle")
          .addEventListener("click", toggleTheme);
        document
          .querySelector(".header-btn")
          .addEventListener("click", openContactModal);
        document
          .querySelector(".close")
          .addEventListener("click", closeContactModal);

        // PWA Installation
        let deferredPrompt;
        const installButton = document.getElementById("installPWA");

        // Check if the app is already installed
        if (window.matchMedia("(display-mode: standalone)").matches) {
          installButton.classList.add("hidden");
        }

        // Show install button for iOS
        const isIOS =
          /iPad|iPhone|iPod/.test(navigator.userAgent) && !window.MSStream;
        if (isIOS) {
          installButton.classList.remove("hidden");
          installButton.addEventListener("click", () => {
            alert(
              'To install this app on your device, tap the Share button and then "Add to Home Screen"'
            );
          });
        } else {
          // Handle standard PWA installation for other devices
          window.addEventListener("beforeinstallprompt", (e) => {
            e.preventDefault();
            deferredPrompt = e;
            installButton.classList.remove("hidden");
          });

          installButton.addEventListener("click", async () => {
            if (!deferredPrompt) return;
            deferredPrompt.prompt();
            const { outcome } = await deferredPrompt.userChoice;
            deferredPrompt = null;
            installButton.classList.add("hidden");
          });
        }

        // Close modal when clicking outside
        window.addEventListener("click", (event) => {
          const modal = document.getElementById("contactModal");
          if (event.target === modal) {
            closeContactModal();
          }
        });
      });
    </script>
  </body>
</html>
